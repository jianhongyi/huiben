!function(){if(!("do_external"in window)){var n,t,r,e;Array.from||(Array.from=(n=Object.prototype.toString,t=function(t){return"function"==typeof t||"[object Function]"===n.call(t)},r=Math.pow(2,53)-1,e=function(n){var t=function(n){var t=Number(n);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t}(n);return Math.min(Math.max(t,0),r)},function(n){var r,o,i,a,c,u,f=Object(n);if(null==n)throw new TypeError("Array.from requires an array-like object - not null or undefined");if(void 0!==(r=arguments.length>1?arguments[1]:void 0)){if(!t(r))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(o=arguments[2])}for(i=e(f.length),a=t(this)?Object(new this(i)):new Array(i),c=0;i>c;)u=f[c],a[c]=r?void 0===o?r(u,c):r.call(o,u,c):u,c+=1;return a.length=i,a}));var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},i=function(n){if("string"==typeof n)try{var t=JSON.parse(n),r=void 0===t?"undefined":o(t);if("object"===r||"boolean"===r)return t}catch(n){}return n},a=function(n){return"readingjourney."+n},c=function(n,t,r){try{Object.defineProperty(n,t,{value:r,configurable:!1,enumerable:!1,writable:!1})}catch(n){}},u=function(n,t){return Object.prototype.toString.call(n)==="[object "+t+"]"},f=function(n,t){var r,e=(r=n,Array.isArray(r)?r:Array.from(r)),o=e[0],i=e[1],a=e.slice(2),c="ELSE";if(u(o,"Object"))c="METHOD";else if(u(i,"Object"))c="OBJ_PARAM";else if(u(i,"Function"))c="FN_PARAM";else{var f=a[a.length-1];u(f,"Function")?i=[i].concat(T(a.slice(0,-1))):(void 0===i||(i=[i].concat(T(a))),f=void 0),a=f}return t[c](o,i,a)},l=function(){},d=void 0===window.orientation,s=document,h=s.removeEventListener.bind(s),m=s.addEventListener.bind(s),y={},v=function(n){return Array.isArray(y[n])},b=function(n){h(n._method,n.build)},p=function(n){y[n]=null},A=d?l:function(n,t,r){if(!u(n,"String")||!u(t,"Function"))throw new TypeError("method must be String, and cb must be Function");var e,o=function(n){n[0]=i(n[0]),t.apply(void 0,T(n))},c=a(n);if("RANDOM"!==r){if(!(this instanceof A))return new A(n,t,r);var f=window.vox,d=f.task,s=f._task,v=function(t,r){void 0===s[n]&&(s[n]=t),s[n]===t&&o(r)};e=function(n){r&&h(n.type,e),v("TRIGGER",n.detail)},d[n]=function(){for(var t=arguments.length,e=Array(t),o=0;o<t;o++)e[o]=arguments[o];r&&(d[n]=l),v("VOX",e)},this.method=n,this.cb=t,m(c,e),y[n]||(y[n]=[]),y[n].push({origin:t,_method:c,build:e})}else m(c,e=function(n){o(n.detail),h(n.type,e)})};A.has=function(n,t){return v(n)&&("function"!=typeof t||y[n].some(function(n){return n.origin===t}))},A.remove=function(n,t){v(n)&&("function"!=typeof t?(y[n].forEach(b),p(n)):0===y[n].reduce(function(n,r,e,o){return r.origin===t?(b(r),delete o[e],n):++n},0)&&p(n))},A.prototype.remove=function(){A.remove(this.method,this.cb),this.remove=l,this.method=this.cb=null};var w=window;u(w.vox,"Object")?w.vox.task||(w.vox.task={}):w.vox={task:{}},c(w.vox,"_task",{});var g=function(){try{return window.webkit.messageHandlers.readingjourney.postMessage,!0}catch(n){return!1}}()?function(){var n=void 0,t=0,r=function(n,r,e){var o;if(e){var i="SHAKS_"+ ++t;A(i,e,"RANDOM"),o=a(i)}window.webkit.messageHandlers.readingjourney.postMessage({method:n,param:r,callback:o})};return{check_external:n=function(n,t){"methodExists"!==n?r("methodExists",{name:n},function(n){t(n.exist)}):t(!0)},do_external:function(){for(var t=arguments.length,e=Array(t),o=0;o<t;o++)e[o]=arguments[o];var i=f(e,{METHOD:function(n){return n},OBJ_PARAM:function(n,t,r){return{method:n,param:t,cb:r[0]}},FN_PARAM:function(n,t){return{method:n,cb:t}},ELSE:function(n,t,r){return{method:n,param:t&&t.reduce(function(n,t,r){return n[r]=t,n},{}),cb:r}}}),a=i.method,c=i.param,u=i.cb;u?n(a,function(n){if(!n)return console.warn(a+" DO NOT EXIST IN EXTERNAL"),void u(null,"NO METHOD");r(a,c,u)}):r(a,c)}}}():function(){var n,t=function t(r,e){switch(t.done){case 1:e(r in window.readingjourney);break;case 0:e(!1);break;default:n("getInitParams",function(n,o){"NO EXTERNAL"===o?(t.done=0,t(r,e)):(t.done=1,t(r,e))})}},r=[],e=function(){for(var n=arguments.length,t=Array(n),e=0;e<n;e++)t[e]=arguments[e];console.warn("MOGAI NOT READY"),r.push(t)},o=-1,a=void 0,c=function(){if(d||++o>18)e=function(n,t,r){console.warn("NOT FOUND MOGAI EXTERNAL METHOD"),r(null,"NO EXTERNAL")},clearInterval(a);else try{window.readingjourney.getInitParams(),clearInterval(a),t.done=1,e=function(n,r,e){t(n,function(t){if(t)try{var o;e(i((o=window.readingjourney)[n].apply(o,T(r))))}catch(n){e(null,n)}else console.warn(n+" DO NOT EXIST IN EXTERNAL"),e(null,"NO METHOD")})}}catch(n){return}r.forEach(function(n){e.apply(void 0,T(n))})};a=setInterval(c,20),c();var u=function(n){return n?[JSON.stringify(n)]:[]};return{check_external:t,do_external:n=function(){for(var n=arguments.length,t=Array(n),r=0;r<n;r++)t[r]=arguments[r];var o=f(t,{METHOD:function(n){var t=n.method,r=n.param,e=n.cb;return{method:t,param:u(r),cb:e}},OBJ_PARAM:function(n,t,r){return{method:n,param:u(t),cb:r[0]}},FN_PARAM:function(n,t){return{method:n,param:[],cb:t}},ELSE:function(n,t,r){return{method:n,param:t||[],cb:r}}}),i=o.method,a=o.param,c=o.cb;e(i,a,void 0===c?l:c)}}}(),O=g.do_external,E=g.check_external,N={do_external:O,bind_trigger:A,check_external:E};for(var M in N)N.hasOwnProperty(M)&&c(w,M,N[M])}function T(n){if(Array.isArray(n)){for(var t=0,r=Array(n.length);t<n.length;t++)r[t]=n[t];return r}return Array.from(n)}}();
